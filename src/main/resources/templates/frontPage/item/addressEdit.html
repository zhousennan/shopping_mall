
<html lang="zh-cmn-Hans">
<head>
    <meta charset="UTF-8">
    <link rel="shortcut icon" href="/frontStatic/favicon.ico">
    <link rel="stylesheet" href="/frontStatic/css/iconfont.css">
    <link rel="stylesheet" href="/frontStatic/css/global.css">
    <link rel="stylesheet" href="/frontStatic/css/bootstrap.min.css">
    <link rel="stylesheet" href="/frontStatic/css/bootstrap-theme.min.css">
    <link rel="stylesheet" href="/frontStatic/css/swiper.min.css">
    <link rel="stylesheet" href="/frontStatic/css/styles.css">
    <script src="/frontStatic/js/jquery.1.12.4.min.js" charset="UTF-8"></script>
    <script src="/frontStatic/js/bootstrap.min.js" charset="UTF-8"></script>
    <script src="/frontStatic/js/swiper.min.js" charset="UTF-8"></script>
    <script src="/frontStatic/js/global.js" charset="UTF-8"></script>
    <!-- <script src="js/jquery.DJMask.2.1.1.js" charset="UTF-8"></script> -->
    <title>古风家</title>
</head>
<body>
<!-- 顶部tab -->
<div th:replace="frontPage/fragment2/head2"></div>
<div class="content clearfix bgf5">
    <section class="user-center inner clearfix">

        <div th:replace="frontPage/fragment2/sidebar"></div>
        <div class="pull-right">
            <div class="user-content__box clearfix bgf">
                <div class="title">账户信息-编辑收货地址</div>
                <form   class="user-addr__form form-horizontal" role="form">
                    <p class="fz18 cr">编辑收货地址<span class="c6" style="margin-left: 20px">电话号码、手机号码选填一项，其余均为必填项</span></p>
                    <div class="form-group">
                        <label for="name" class="col-sm-2 control-label">收货人姓名：</label>
                        <div class="col-sm-6">
                            <input class="form-control" id="name" value="" placeholder="请输入姓名" type="text">
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="details" class="col-sm-2 control-label">收货地址：</label>
                        <div class="col-sm-10">
                            <div class="addr-linkage" >
                                <select name="province" id="province" >

                                </select>
                                <select name="city" id="city"></select>
                                <select name="area" id="area"></select>

                            </div>
                            <input class="form-control" id="details" placeholder="建议您如实填写详细收货地址，例如街道名称，门牌号码等信息" maxlength="30" value="" type="text">
                        </div>
                    </div>

                    <div class="form-group">
                        <label for="mobile" class="col-sm-2 control-label">手机号码：</label>
                        <div class="col-sm-6">
                            <input class="form-control" id="mobile" value="" placeholder="请输入手机号码" type="text">
                        </div>
                    </div>


                    <div class="form-group">
                        <div class="col-sm-offset-2 col-sm-6">
                            <button type="button" onclick="saveAddressProvince()" class="but">保存</button>
                        </div>
                    </div>
                    <script src="/frontStatic/js/jquery.citys.js"></script>
                    <script>
                        $(document).ready(function(){
                            $('.addr-linkage').citys({
                                // 如果某天这个仓库地址失效了dataUrl请使用本地 2017.10 的数据 'js/data_location/list.json'
                                dataUrl: 'http://passer-by.com/data_location/list.json',
                                // spareUrl: '/frontStatic/js/data_location/list.json',
                                dataType: 'json',
                                valueType: 'name',
                                province: '四川省',
                                city:'成都市',
                                area: '金牛区',
                                onChange: function(data) {
                                },
                            });
                        });
                        function saveAddressProvince(){
                            var addressInfo={};
                            addressInfo.address=$("#province").val()+$("#city").val()+$("#area").val()+$("#details").val();
                            addressInfo.telPhone=$("#mobile").val();
                            addressInfo.receiverName=$("#name").val();
                            $.ajax({
                                 url: "/api/insertAddress",
                                 type: "post",
                                contentType: "application/json",
                                data : JSON.stringify(addressInfo),
                                 success:function (data) {},
                                 error: function (data) {
                                     layer.alert(data.responseText, {icon: 0});
                                 }
                             })

                        }
                    </script>
                </form>
                <p class="fz18 cr">已保存的有效地址</p>
                <div class="table-thead addr-thead">
                    <div class="tdf1">收货人</div>
                    <div class="tdf3"><div class="tdt-a_l">详细地址</div></div>
                    <!-- <div class="tdf1">邮编</div> -->
                    <div class="tdf1">电话/手机</div>
                    <div class="tdf1">操作</div>
                    <div class="tdf1"></div>
                </div>

                <div class="addr-list" id="listAddress">
                </div>
            </div>
        </div>
    </section>
</div>
<script>
    $(document).ready(function () {
        initAddressSave();
    });
   function initAddressSave(){
       $.ajax({
           url: "/api/getAddress",
           type: "get",
           success:function (data) {
               html = "";
               for (var  i = 0; i < data.length ; i++) {
                   html +="<div class=\"addr-item\">\n" +
                       "                        <div class=\"tdf1\">"+data[i].receiverName+"</div>\n" +
                       "                        <div class=\"tdf2 tdt-a_l\">"+data[i].address+"</div>\n" +
                       "                        <div class=\"tdf1\">"+data[i].telPhone+"</div>\n" +
                       "                        <div class=\"tdf1 order\">\n" +
                       "                           <a href='javascript:void(0);' onclick='deleteAddress(\"" + data[i].addressId + "\")'  \">删除</a>\n" +
                       "                        </div>\n" +
                       "                        <div class=\"tdf1\">\n" +
                       "                           \n" +
                       "                        </div>\n" +
                       "                    </div>"
               }
            $("#listAddress").append(html);
           },
       })

   }
    function deleteAddress(id) {
        $.ajax({
            url:"/api/deletedAddress/"+id,
            type:"delete",
            success:function (data) {
                window.location.href = "/front/addressEdit";
            },
            error:function () {
                alert("出错了")
            }
        })
    }


</script>
<!-- 底部信息 -->
<div th:replace="frontPage/fragments/footer"></div>
</body>
</html>